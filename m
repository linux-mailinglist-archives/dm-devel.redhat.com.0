Return-Path: <dm-devel-bounces@redhat.com>
X-Original-To: lists+dm-devel@lfdr.de
Delivered-To: lists+dm-devel@lfdr.de
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mail.lfdr.de (Postfix) with ESMTPS id 02B064BCAA
	for <lists+dm-devel@lfdr.de>; Wed, 19 Jun 2019 17:21:18 +0200 (CEST)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com [10.5.11.15])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mx1.redhat.com (Postfix) with ESMTPS id 53F543082AEF;
	Wed, 19 Jun 2019 15:20:42 +0000 (UTC)
Received: from colo-mx.corp.redhat.com (colo-mx02.intmail.prod.int.phx2.redhat.com [10.5.11.21])
	by smtp.corp.redhat.com (Postfix) with ESMTPS id D153C5D719;
	Wed, 19 Jun 2019 15:20:23 +0000 (UTC)
Received: from lists01.pubmisc.prod.ext.phx2.redhat.com (lists01.pubmisc.prod.ext.phx2.redhat.com [10.5.19.33])
	by colo-mx.corp.redhat.com (Postfix) with ESMTP id 397FF206D2;
	Wed, 19 Jun 2019 15:19:41 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
	[10.5.11.23])
	by lists01.pubmisc.prod.ext.phx2.redhat.com (8.13.8/8.13.8) with ESMTP
	id x5JFIZWT031223 for <dm-devel@listman.util.phx.redhat.com>;
	Wed, 19 Jun 2019 11:18:35 -0400
Received: by smtp.corp.redhat.com (Postfix)
	id 51DD419C6F; Wed, 19 Jun 2019 15:18:35 +0000 (UTC)
Delivered-To: dm-devel@redhat.com
Received: from mx1.redhat.com (ext-mx13.extmail.prod.ext.phx2.redhat.com
	[10.5.110.42])
	by smtp.corp.redhat.com (Postfix) with ESMTPS id 4ADE819C6A
	for <dm-devel@redhat.com>; Wed, 19 Jun 2019 15:18:32 +0000 (UTC)
Received: from mail-lj1-f194.google.com (mail-lj1-f194.google.com
	[209.85.208.194])
	(using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
	(No client certificate requested)
	by mx1.redhat.com (Postfix) with ESMTPS id F27F13086233
	for <dm-devel@redhat.com>; Wed, 19 Jun 2019 15:18:18 +0000 (UTC)
Received: by mail-lj1-f194.google.com with SMTP id a21so3648876ljh.7
	for <dm-devel@redhat.com>; Wed, 19 Jun 2019 08:18:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
	h=mime-version:references:in-reply-to:from:date:message-id:subject:to
	:cc:content-transfer-encoding;
	bh=U94P+ouHgJbaSvcfWP1axYxMhCkORcAQtztfyhiDkbk=;
	b=Y1yf/0TUIBjcxDiieCutpKW9TUN/Ic9bGh/J6Wlm0Y0CTQtxd9t7iJLMExAQYFS+Kr
	E097Rp8i9DDYbRdu/lSwHpXOw/Ud23EFJMZ0Pm1q4MGVTAYtZkfD2BnL8VrSNUZ9pn6g
	bnLfUoc8jd/1CYF416OCz8Qa8rSipZHBMgJCjiUcfbC6zpLCYyHt7Ehi90tM7TH2kh4b
	aGjJYilYEWdN7PUR52gwqdGjQHHCVOCsTCrAr6ft06R5q7iWv0YwZNd2T3o3/Yhcp5i9
	MoyfeGD7Y3IilXMOOybzju13zX7rFGcxBJD3pJl6CitufoQ+Urxk+pKZQLIz+rnZSnrR
	AexA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20161025;
	h=x-gm-message-state:mime-version:references:in-reply-to:from:date
	:message-id:subject:to:cc:content-transfer-encoding;
	bh=U94P+ouHgJbaSvcfWP1axYxMhCkORcAQtztfyhiDkbk=;
	b=KLtT4gG6xwqcX4eeeIzkk5HlwAt/GtYvXzapiQv1JZR6glpqbrq1K8gXlt7pQCybHA
	wL4xqUWpatMHvv+bXxrDmmAy+g+LLgNgO3nT7c02hj284aTr0tN4EODYvEI6yxuYNmPZ
	UR32Gq3AVSRKCl6cjJ2bMqXiXVr3PSpmfhXeZn1yFzM6qxt/wA6cxBMruHbEAIkaMeK9
	4brYNvBEKpzVzdzAi8poGR6OilMqQtsBHXD038aU+WQgFxy8+VBNjfx1ErkCsuW2hQHa
	veSlzo6SynFU5Xs7bzctZgJIwNLBwhFw71S7SgpHvQyHgr84/Oh2koX2fRf72E2OxH8m
	GZQw==
X-Gm-Message-State: APjAAAWxPVMpLzxuOvZisZEglvuwl7lzNzj0bHDjxrFufAINaLxB76JH
	OWLpeD0DV8sHYUEh8tnmhFkOsXPicx8iLe5EoxA=
X-Google-Smtp-Source: APXvYqw0rALt6eQG7l+sBu4xHCXPpOLu9YG2ioh3/vtQhoHzXBadk5rKiL0y00/Hv/68MIUA1iHEd8SphxC+m9/M5Yc=
X-Received: by 2002:a2e:9c06:: with SMTP id s6mr10380245lji.135.1560957497356; 
	Wed, 19 Jun 2019 08:18:17 -0700 (PDT)
MIME-Version: 1.0
References: <20190618212749.8995-1-ard.biesheuvel@linaro.org>
	<20190618212749.8995-2-ard.biesheuvel@linaro.org>
In-Reply-To: <20190618212749.8995-2-ard.biesheuvel@linaro.org>
From: =?UTF-8?B?T25kcmVqIE1vc27DocSNZWs=?= <omosnacek@gmail.com>
Date: Wed, 19 Jun 2019 17:18:05 +0200
Message-ID: <CAAUqJDsi_acZj09xiimYGfyJVPt0zo=3-2PHuGnSKSaq82-RQA@mail.gmail.com>
To: Ard Biesheuvel <ard.biesheuvel@linaro.org>
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
	(mx1.redhat.com [10.5.110.42]);
	Wed, 19 Jun 2019 15:18:19 +0000 (UTC)
X-Greylist: inspected by milter-greylist-4.5.16 (mx1.redhat.com [10.5.110.42]);
	Wed, 19 Jun 2019 15:18:19 +0000 (UTC) for IP:'209.85.208.194'
	DOMAIN:'mail-lj1-f194.google.com'
	HELO:'mail-lj1-f194.google.com' FROM:'omosnacek@gmail.com' RCPT:''
X-RedHat-Spam-Score: -0.098  (DKIM_SIGNED, DKIM_VALID, DKIM_VALID_AU,
	FREEMAIL_FROM, FROM_EXCESS_BASE64, SPF_HELO_NONE,
	SPF_PASS) 209.85.208.194 mail-lj1-f194.google.com 209.85.208.194
	mail-lj1-f194.google.com <omosnacek@gmail.com>
X-Scanned-By: MIMEDefang 2.84 on 10.5.110.42
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-MIME-Autoconverted: from quoted-printable to 8bit by
	lists01.pubmisc.prod.ext.phx2.redhat.com id x5JFIZWT031223
X-loop: dm-devel@redhat.com
Cc: Herbert Xu <herbert@gondor.apana.org.au>,
	Eric Biggers <ebiggers@google.com>, linux-fscrypt@vger.kernel.org,
	Gilad Ben-Yossef <gilad@benyossef.com>, dm-devel@redhat.com,
	linux-crypto@vger.kernel.org, Milan Broz <gmazyland@gmail.com>
Subject: Re: [dm-devel] [PATCH v2 1/4] crypto: essiv - create wrapper
	template for ESSIV generation
X-BeenThere: dm-devel@redhat.com
X-Mailman-Version: 2.1.12
Precedence: junk
List-Id: device-mapper development <dm-devel.redhat.com>
List-Unsubscribe: <https://www.redhat.com/mailman/options/dm-devel>,
	<mailto:dm-devel-request@redhat.com?subject=unsubscribe>
List-Archive: <https://www.redhat.com/archives/dm-devel>
List-Post: <mailto:dm-devel@redhat.com>
List-Help: <mailto:dm-devel-request@redhat.com?subject=help>
List-Subscribe: <https://www.redhat.com/mailman/listinfo/dm-devel>,
	<mailto:dm-devel-request@redhat.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: dm-devel-bounces@redhat.com
Errors-To: dm-devel-bounces@redhat.com
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16 (mx1.redhat.com [10.5.110.45]); Wed, 19 Jun 2019 15:21:16 +0000 (UTC)

SGkgQXJkLAoKdXQgMTguIDYuIDIwMTkgbyAyMzoyOCBBcmQgQmllc2hldXZlbCA8YXJkLmJpZXNo
ZXV2ZWxAbGluYXJvLm9yZz4gbmFww61zYWwoYSk6Cj4gSW1wbGVtZW50IGEgdGVtcGxhdGUgdGhh
dCB3cmFwcyBhIChza2NpcGhlcixjaXBoZXIsc2hhc2gpIG9yCj4gKGFlYWQsY2lwaGVyLHNoYXNo
KSB0dXBsZSBzbyB0aGF0IHdlIGNhbiBjb25zb2xpZGF0ZSB0aGUgRVNTSVYgaGFuZGxpbmcKPiBp
biBmc2NyeXB0IGFuZCBkbS1jcnlwdCBhbmQgbW92ZSBpdCBpbnRvIHRoZSBjcnlwdG8gQVBJLiBU
aGlzIHdpbGwgcmVzdWx0Cj4gaW4gYmV0dGVyIHRlc3QgY292ZXJhZ2UsIGFuZCB3aWxsIGFsbG93
IGZ1dHVyZSBjaGFuZ2VzIHRvIG1ha2UgdGhlIGJhcmUKPiBjaXBoZXIgaW50ZXJmYWNlIGludGVy
bmFsIHRvIHRoZSBjcnlwdG8gc3Vic3lzdGVtLCBpbiBvcmRlciB0byBpbmNyZWFzZQo+IHJvYnVz
dG5lc3Mgb2YgdGhlIEFQSSBhZ2FpbnN0IG1pc3VzZS4KPgo+IE5vdGUgdGhhdCBlc3BlY2lhbGx5
IHRoZSBBRUFEIGhhbmRsaW5nIGlzIGEgYml0IGNvbXBsZXgsIGFuZCBpcyB0aWdodGx5Cj4gY291
cGxlZCB0byB0aGUgd2F5IGRtLWNyeXB0IGNvbWJpbmVzIEFFQUQgYmFzZWQgb24gdGhlIGF1dGhl
bmMoKSB0ZW1wbGF0ZQo+IHdpdGggdGhlIEVTU0lWIGhhbmRsaW5nLgoKV291bGRuJ3QgaXQgd29y
ayBiZXR0ZXIgdG8gaGF2ZSBhIHRlbXBsYXRlIG9ubHkgZm9yIHNrY2lwaGVyIGFuZCBpbgpkbS1j
cnlwdCBqdXN0IGluamVjdCB0aGUgZXNzaXYoKSB0ZW1wbGF0ZSBpbnRvIHRoZSBjaXBoZXIgc3Ry
aW5nPyBGb3IKZXhhbXBsZTogImF1dGhlbmMoaG1hYyhzaGEyNTYpLGNiYyhhZXMpKS1lc3Npdjpz
aGEyNTYiIC0+CiJhdXRoZW5jKGhtYWMoc2hhMjU2KSxlc3NpdihjYmMoYWVzKSxhZXMsc2hhMjU2
KSkiLiBUaGF0IHNlZW1zIHRvIG1lIGEKbXVjaCBzaW1wbGVyIGhhY2suIChCdXQgbWF5YmUgSSdt
IG1pc3Npbmcgc29tZSBpc3N1ZSBpbiB0aGF0CmFwcHJvYWNoLi4uKQoKCj4KPiBTaWduZWQtb2Zm
LWJ5OiBBcmQgQmllc2hldXZlbCA8YXJkLmJpZXNoZXV2ZWxAbGluYXJvLm9yZz4KPiAtLS0KPiAg
Y3J5cHRvL0tjb25maWcgIHwgICA0ICsKPiAgY3J5cHRvL01ha2VmaWxlIHwgICAxICsKPiAgY3J5
cHRvL2Vzc2l2LmMgIHwgNjI0ICsrKysrKysrKysrKysrKysrKysrCj4gIDMgZmlsZXMgY2hhbmdl
ZCwgNjI5IGluc2VydGlvbnMoKykKPgo+IGRpZmYgLS1naXQgYS9jcnlwdG8vS2NvbmZpZyBiL2Ny
eXB0by9LY29uZmlnCj4gaW5kZXggM2QwNTZlN2RhNjVmLi4xYWE0NzA4N2MxYTIgMTAwNjQ0Cj4g
LS0tIGEvY3J5cHRvL0tjb25maWcKPiArKysgYi9jcnlwdG8vS2NvbmZpZwo+IEBAIC0xOTE3LDYg
KzE5MTcsMTAgQEAgY29uZmlnIENSWVBUT19TVEFUUwo+ICBjb25maWcgQ1JZUFRPX0hBU0hfSU5G
Two+ICAgICAgICAgYm9vbAo+Cj4gK2NvbmZpZyBDUllQVE9fRVNTSVYKPiArICAgICAgIHRyaXN0
YXRlCj4gKyAgICAgICBzZWxlY3QgQ1JZUFRPX0FVVEhFTkMKPiArCj4gIHNvdXJjZSAiZHJpdmVy
cy9jcnlwdG8vS2NvbmZpZyIKPiAgc291cmNlICJjcnlwdG8vYXN5bW1ldHJpY19rZXlzL0tjb25m
aWciCj4gIHNvdXJjZSAiY2VydHMvS2NvbmZpZyIKPiBkaWZmIC0tZ2l0IGEvY3J5cHRvL01ha2Vm
aWxlIGIvY3J5cHRvL01ha2VmaWxlCj4gaW5kZXggMjY2YTRjZGJiOWUyLi5hZDFkOTliYTZkNTYg
MTAwNjQ0Cj4gLS0tIGEvY3J5cHRvL01ha2VmaWxlCj4gKysrIGIvY3J5cHRvL01ha2VmaWxlCj4g
QEAgLTE0OCw2ICsxNDgsNyBAQCBvYmotJChDT05GSUdfQ1JZUFRPX1VTRVJfQVBJX0FFQUQpICs9
IGFsZ2lmX2FlYWQubwo+ICBvYmotJChDT05GSUdfQ1JZUFRPX1pTVEQpICs9IHpzdGQubwo+ICBv
YmotJChDT05GSUdfQ1JZUFRPX09GQikgKz0gb2ZiLm8KPiAgb2JqLSQoQ09ORklHX0NSWVBUT19F
Q0MpICs9IGVjYy5vCj4gK29iai0kKENPTkZJR19DUllQVE9fRVNTSVYpICs9IGVzc2l2Lm8KPgo+
ICBlY2RoX2dlbmVyaWMteSArPSBlY2RoLm8KPiAgZWNkaF9nZW5lcmljLXkgKz0gZWNkaF9oZWxw
ZXIubwo+IGRpZmYgLS1naXQgYS9jcnlwdG8vZXNzaXYuYyBiL2NyeXB0by9lc3Npdi5jCj4gbmV3
IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjAyOWE2NWFmYjRkNwo+IC0t
LSAvZGV2L251bGwKPiArKysgYi9jcnlwdG8vZXNzaXYuYwo+IEBAIC0wLDAgKzEsNjI0IEBACj4g
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIEVTU0lWIHNr
Y2lwaGVyIHRlbXBsYXRlIGZvciBibG9jayBlbmNyeXB0aW9uCj4gKyAqCj4gKyAqIENvcHlyaWdo
dCAoYykgMjAxOSBMaW5hcm8sIEx0ZC4gPGFyZC5iaWVzaGV1dmVsQGxpbmFyby5vcmc+Cj4gKyAq
Cj4gKyAqIEhlYXZpbHkgYmFzZWQgb246Cj4gKyAqIGFkaWFudHVtIGxlbmd0aC1wcmVzZXJ2aW5n
IGVuY3J5cHRpb24gbW9kZQo+ICsgKgo+ICsgKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDCj4g
KyAqLwo+ICsKPiArI2luY2x1ZGUgPGNyeXB0by9hdXRoZW5jLmg+Cj4gKyNpbmNsdWRlIDxjcnlw
dG8vaW50ZXJuYWwvYWVhZC5oPgo+ICsjaW5jbHVkZSA8Y3J5cHRvL2ludGVybmFsL2hhc2guaD4K
PiArI2luY2x1ZGUgPGNyeXB0by9pbnRlcm5hbC9za2NpcGhlci5oPgo+ICsjaW5jbHVkZSA8Y3J5
cHRvL3NjYXR0ZXJ3YWxrLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArCj4gKyNp
bmNsdWRlICJpbnRlcm5hbC5oIgo+ICsKPiArI2RlZmluZSBFU1NJVl9JVl9TSVpFICAgICAgICAg
IHNpemVvZih1NjQpICAgICAvLyBJViBzaXplIG9mIHRoZSBvdXRlciBhbGdvCj4gKyNkZWZpbmUg
TUFYX0lOTkVSX0lWX1NJWkUgICAgICAxNiAgICAgICAgICAgICAgLy8gbWF4IElWIHNpemUgb2Yg
aW5uZXIgYWxnbwo+ICsKPiArc3RydWN0IGVzc2l2X2luc3RhbmNlX2N0eCB7Cj4gKyAgICAgICB1
bmlvbiB7Cj4gKyAgICAgICAgICAgICAgIHN0cnVjdCBjcnlwdG9fc2tjaXBoZXJfc3Bhd24gICAg
YmxvY2tjaXBoZXJfc3Bhd247Cj4gKyAgICAgICAgICAgICAgIHN0cnVjdCBjcnlwdG9fYWVhZF9z
cGF3biAgICAgICAgYWVhZF9zcGF3bjsKPiArICAgICAgIH0gdTsKPiArICAgICAgIHN0cnVjdCBj
cnlwdG9fc3Bhd24gICAgICAgICAgICAgICAgICAgICBlc3Npdl9jaXBoZXJfc3Bhd247Cj4gKyAg
ICAgICBzdHJ1Y3QgY3J5cHRvX3NoYXNoX3NwYXduICAgICAgICAgICAgICAgaGFzaF9zcGF3bjsK
PiArfTsKPiArCj4gK3N0cnVjdCBlc3Npdl90Zm1fY3R4IHsKPiArICAgICAgIHVuaW9uIHsKPiAr
ICAgICAgICAgICAgICAgc3RydWN0IGNyeXB0b19za2NpcGhlciAgKmJsb2NrY2lwaGVyOwo+ICsg
ICAgICAgICAgICAgICBzdHJ1Y3QgY3J5cHRvX2FlYWQgICAgICAqYWVhZDsKPiArICAgICAgIH0g
dTsKPiArICAgICAgIHN0cnVjdCBjcnlwdG9fY2lwaGVyICAgICAgICAgICAgKmVzc2l2X2NpcGhl
cjsKPiArICAgICAgIHN0cnVjdCBjcnlwdG9fc2hhc2ggICAgICAgICAgICAgKmhhc2g7Cj4gK307
Cj4gKwo+ICtzdHJ1Y3QgZXNzaXZfc2tjaXBoZXJfcmVxdWVzdF9jdHggewo+ICsgICAgICAgdTgg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdltNQVhfSU5ORVJfSVZfU0laRV07Cj4gKyAg
ICAgICBzdHJ1Y3Qgc2tjaXBoZXJfcmVxdWVzdCAgICAgICAgIGJsb2NrY2lwaGVyX3JlcTsKPiAr
fTsKPiArCj4gK3N0cnVjdCBlc3Npdl9hZWFkX3JlcXVlc3RfY3R4IHsKPiArICAgICAgIHU4ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaXZbTUFYX0lOTkVSX0lWX1NJWkVdOwo+ICsgICAg
ICAgc3RydWN0IHNjYXR0ZXJsaXN0ICAgICAgICAgICAgICBzcmNbNF0sIGRzdFs0XTsKPiArICAg
ICAgIHN0cnVjdCBhZWFkX3JlcXVlc3QgICAgICAgICAgICAgYWVhZF9yZXE7Cj4gK307Cj4gKwo+
ICtzdGF0aWMgaW50IGVzc2l2X3NrY2lwaGVyX3NldGtleShzdHJ1Y3QgY3J5cHRvX3NrY2lwaGVy
ICp0Zm0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdTggKmtleSwg
dW5zaWduZWQgaW50IGtleWxlbikKPiArewo+ICsgICAgICAgdTMyIGZsYWdzID0gY3J5cHRvX3Nr
Y2lwaGVyX2dldF9mbGFncyh0Zm0pICYgQ1JZUFRPX1RGTV9SRVFfTUFTSzsKPiArICAgICAgIHN0
cnVjdCBlc3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX3NrY2lwaGVyX2N0eCh0Zm0pOwo+ICsg
ICAgICAgU0hBU0hfREVTQ19PTl9TVEFDSyhkZXNjLCB0Y3R4LT5oYXNoKTsKPiArICAgICAgIHVu
c2lnbmVkIGludCBzYWx0c2l6ZTsKPiArICAgICAgIHU4ICpzYWx0Owo+ICsgICAgICAgaW50IGVy
cjsKPiArCj4gKyAgICAgICBjcnlwdG9fc2tjaXBoZXJfY2xlYXJfZmxhZ3ModGN0eC0+dS5ibG9j
a2NpcGhlciwgQ1JZUFRPX1RGTV9SRVFfTUFTSyk7Cj4gKyAgICAgICBjcnlwdG9fc2tjaXBoZXJf
c2V0X2ZsYWdzKHRjdHgtPnUuYmxvY2tjaXBoZXIsIGZsYWdzKTsKPiArICAgICAgIGVyciA9IGNy
eXB0b19za2NpcGhlcl9zZXRrZXkodGN0eC0+dS5ibG9ja2NpcGhlciwga2V5LCBrZXlsZW4pOwo+
ICsgICAgICAgY3J5cHRvX3NrY2lwaGVyX3NldF9mbGFncyh0Zm0sCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNyeXB0b19za2NpcGhlcl9nZXRfZmxhZ3ModGN0eC0+dS5ibG9j
a2NpcGhlcikgJgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUllQVE9fVEZN
X1JFU19NQVNLKTsKPiArICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBl
cnI7Cj4gKwo+ICsgICAgICAgc2FsdHNpemUgPSBjcnlwdG9fc2hhc2hfZGlnZXN0c2l6ZSh0Y3R4
LT5oYXNoKTsKPiArICAgICAgIHNhbHQgPSBrbWFsbG9jKHNhbHRzaXplLCBHRlBfS0VSTkVMKTsK
PiArICAgICAgIGlmICghc2FsdCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4g
Kwo+ICsgICAgICAgZGVzYy0+dGZtID0gdGN0eC0+aGFzaDsKPiArICAgICAgIGNyeXB0b19zaGFz
aF9kaWdlc3QoZGVzYywga2V5LCBrZXlsZW4sIHNhbHQpOwo+ICsKPiArICAgICAgIGNyeXB0b19j
aXBoZXJfY2xlYXJfZmxhZ3ModGN0eC0+ZXNzaXZfY2lwaGVyLCBDUllQVE9fVEZNX1JFUV9NQVNL
KTsKPiArICAgICAgIGNyeXB0b19jaXBoZXJfc2V0X2ZsYWdzKHRjdHgtPmVzc2l2X2NpcGhlciwg
ZmxhZ3MgJiBDUllQVE9fVEZNX1JFUV9NQVNLKTsKPiArICAgICAgIGVyciA9IGNyeXB0b19jaXBo
ZXJfc2V0a2V5KHRjdHgtPmVzc2l2X2NpcGhlciwgc2FsdCwgc2FsdHNpemUpOwo+ICsgICAgICAg
ZmxhZ3MgPSBjcnlwdG9fY2lwaGVyX2dldF9mbGFncyh0Y3R4LT5lc3Npdl9jaXBoZXIpICYgQ1JZ
UFRPX1RGTV9SRVNfTUFTSzsKPiArICAgICAgIGNyeXB0b19za2NpcGhlcl9zZXRfZmxhZ3ModGZt
LCBmbGFncyk7Cj4gKwo+ICsgICAgICAga3pmcmVlKHNhbHQpOwo+ICsgICAgICAgcmV0dXJuIGVy
cjsKPiArfQo+ICsKPiArc3RhdGljIGludCBlc3Npdl9hZWFkX3NldGtleShzdHJ1Y3QgY3J5cHRv
X2FlYWQgKnRmbSwgY29uc3QgdTggKmtleSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGludCBrZXlsZW4pCj4gK3sKPiArICAgICAgIHN0cnVjdCBlc3Npdl90Zm1fY3R4
ICp0Y3R4ID0gY3J5cHRvX2FlYWRfY3R4KHRmbSk7Cj4gKyAgICAgICBTSEFTSF9ERVNDX09OX1NU
QUNLKGRlc2MsIHRjdHgtPmhhc2gpOwo+ICsgICAgICAgc3RydWN0IGNyeXB0b19hdXRoZW5jX2tl
eXMga2V5czsKPiArICAgICAgIHVuc2lnbmVkIGludCBzYWx0c2l6ZTsKPiArICAgICAgIHU4ICpz
YWx0Owo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICBjcnlwdG9fYWVhZF9jbGVhcl9m
bGFncyh0Y3R4LT51LmFlYWQsIENSWVBUT19URk1fUkVRX01BU0spOwo+ICsgICAgICAgY3J5cHRv
X2FlYWRfc2V0X2ZsYWdzKHRjdHgtPnUuYWVhZCwgY3J5cHRvX2FlYWRfZ2V0X2ZsYWdzKHRmbSkg
Jgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1JZUFRPX1RG
TV9SRVFfTUFTSyk7Cj4gKyAgICAgICBlcnIgPSBjcnlwdG9fYWVhZF9zZXRrZXkodGN0eC0+dS5h
ZWFkLCBrZXksIGtleWxlbik7Cj4gKyAgICAgICBjcnlwdG9fYWVhZF9zZXRfZmxhZ3ModGZtLCBj
cnlwdG9fYWVhZF9nZXRfZmxhZ3ModGN0eC0+dS5hZWFkKSAmCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBDUllQVE9fVEZNX1JFU19NQVNLKTsKPiArICAgICAgIGlmIChlcnIp
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICsgICAgICAgaWYgKGNyeXB0b19h
dXRoZW5jX2V4dHJhY3RrZXlzKCZrZXlzLCBrZXksIGtleWxlbikgIT0gMCkgewo+ICsgICAgICAg
ICAgICAgICBjcnlwdG9fYWVhZF9zZXRfZmxhZ3ModGZtLCBDUllQVE9fVEZNX1JFU19CQURfS0VZ
X0xFTik7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgfQo+ICsK
PiArICAgICAgIHNhbHRzaXplID0gY3J5cHRvX3NoYXNoX2RpZ2VzdHNpemUodGN0eC0+aGFzaCk7
Cj4gKyAgICAgICBzYWx0ID0ga21hbGxvYyhzYWx0c2l6ZSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAg
ICBpZiAoIXNhbHQpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAg
ICAgIGRlc2MtPnRmbSA9IHRjdHgtPmhhc2g7Cj4gKyAgICAgICBjcnlwdG9fc2hhc2hfaW5pdChk
ZXNjKTsKPiArICAgICAgIGNyeXB0b19zaGFzaF91cGRhdGUoZGVzYywga2V5cy5lbmNrZXksIGtl
eXMuZW5ja2V5bGVuKTsKPiArICAgICAgIGNyeXB0b19zaGFzaF9maW51cChkZXNjLCBrZXlzLmF1
dGhrZXksIGtleXMuYXV0aGtleWxlbiwgc2FsdCk7Cj4gKwo+ICsgICAgICAgY3J5cHRvX2NpcGhl
cl9jbGVhcl9mbGFncyh0Y3R4LT5lc3Npdl9jaXBoZXIsIENSWVBUT19URk1fUkVRX01BU0spOwo+
ICsgICAgICAgY3J5cHRvX2NpcGhlcl9zZXRfZmxhZ3ModGN0eC0+ZXNzaXZfY2lwaGVyLCBjcnlw
dG9fYWVhZF9nZXRfZmxhZ3ModGZtKSAmCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIENSWVBUT19URk1fUkVRX01BU0spOwo+ICsgICAgICAgZXJy
ID0gY3J5cHRvX2NpcGhlcl9zZXRrZXkodGN0eC0+ZXNzaXZfY2lwaGVyLCBzYWx0LCBzYWx0c2l6
ZSk7Cj4gKyAgICAgICBjcnlwdG9fYWVhZF9zZXRfZmxhZ3ModGZtLCBjcnlwdG9fY2lwaGVyX2dl
dF9mbGFncyh0Y3R4LT5lc3Npdl9jaXBoZXIpICYKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIENSWVBUT19URk1fUkVTX01BU0spOwo+ICsKPiArICAgICAgIGt6ZnJlZShzYWx0
KTsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZXNzaXZfYWVh
ZF9zZXRhdXRoc2l6ZShzdHJ1Y3QgY3J5cHRvX2FlYWQgKnRmbSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGF1dGhzaXplKQo+ICt7Cj4gKyAgICAgICBz
dHJ1Y3QgZXNzaXZfdGZtX2N0eCAqdGN0eCA9IGNyeXB0b19hZWFkX2N0eCh0Zm0pOwo+ICsKPiAr
ICAgICAgIHJldHVybiBjcnlwdG9fYWVhZF9zZXRhdXRoc2l6ZSh0Y3R4LT51LmFlYWQsIGF1dGhz
aXplKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXNzaXZfc2tjaXBoZXJfZG9uZShzdHJ1Y3Qg
Y3J5cHRvX2FzeW5jX3JlcXVlc3QgKmFyZXEsIGludCBlcnIpCj4gK3sKPiArICAgICAgIHN0cnVj
dCBza2NpcGhlcl9yZXF1ZXN0ICpyZXEgPSBhcmVxLT5kYXRhOwo+ICsKPiArICAgICAgIHNrY2lw
aGVyX3JlcXVlc3RfY29tcGxldGUocmVxLCBlcnIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBl
c3Npdl9hZWFkX2RvbmUoc3RydWN0IGNyeXB0b19hc3luY19yZXF1ZXN0ICphcmVxLCBpbnQgZXJy
KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgYWVhZF9yZXF1ZXN0ICpyZXEgPSBhcmVxLT5kYXRhOwo+
ICsKPiArICAgICAgIGFlYWRfcmVxdWVzdF9jb21wbGV0ZShyZXEsIGVycik7Cj4gK30KPiArCj4g
K3N0YXRpYyB2b2lkIGVzc2l2X3NrY2lwaGVyX3ByZXBhcmVfc3VicmVxKHN0cnVjdCBza2NpcGhl
cl9yZXF1ZXN0ICpyZXEpCj4gK3sKPiArICAgICAgIHN0cnVjdCBjcnlwdG9fc2tjaXBoZXIgKnRm
bSA9IGNyeXB0b19za2NpcGhlcl9yZXF0Zm0ocmVxKTsKPiArICAgICAgIGNvbnN0IHN0cnVjdCBl
c3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX3NrY2lwaGVyX2N0eCh0Zm0pOwo+ICsgICAgICAg
c3RydWN0IGVzc2l2X3NrY2lwaGVyX3JlcXVlc3RfY3R4ICpyY3R4ID0gc2tjaXBoZXJfcmVxdWVz
dF9jdHgocmVxKTsKPiArICAgICAgIHN0cnVjdCBza2NpcGhlcl9yZXF1ZXN0ICpzdWJyZXEgPSAm
cmN0eC0+YmxvY2tjaXBoZXJfcmVxOwo+ICsKPiArICAgICAgIG1lbXNldChyY3R4LT5pdiwgMCwg
Y3J5cHRvX2NpcGhlcl9ibG9ja3NpemUodGN0eC0+ZXNzaXZfY2lwaGVyKSk7Cj4gKyAgICAgICBt
ZW1jcHkocmN0eC0+aXYsIHJlcS0+aXYsIGNyeXB0b19za2NpcGhlcl9pdnNpemUodGZtKSk7Cj4g
Kwo+ICsgICAgICAgY3J5cHRvX2NpcGhlcl9lbmNyeXB0X29uZSh0Y3R4LT5lc3Npdl9jaXBoZXIs
IHJjdHgtPml2LCByY3R4LT5pdik7Cj4gKwo+ICsgICAgICAgc2tjaXBoZXJfcmVxdWVzdF9zZXRf
dGZtKHN1YnJlcSwgdGN0eC0+dS5ibG9ja2NpcGhlcik7Cj4gKyAgICAgICBza2NpcGhlcl9yZXF1
ZXN0X3NldF9jcnlwdChzdWJyZXEsIHJlcS0+c3JjLCByZXEtPmRzdCwgcmVxLT5jcnlwdGxlbiwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjdHgtPml2KTsKPiArICAgICAg
IHNrY2lwaGVyX3JlcXVlc3Rfc2V0X2NhbGxiYWNrKHN1YnJlcSwgcmVxLT5iYXNlLmZsYWdzLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXNzaXZfc2tjaXBoZXJfZG9u
ZSwgcmVxKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBlc3Npdl9hZWFkX3ByZXBhcmVfc3VicmVx
KHN0cnVjdCBhZWFkX3JlcXVlc3QgKnJlcSkKPiArewo+ICsgICAgICAgc3RydWN0IGNyeXB0b19h
ZWFkICp0Zm0gPSBjcnlwdG9fYWVhZF9yZXF0Zm0ocmVxKTsKPiArICAgICAgIGNvbnN0IHN0cnVj
dCBlc3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX2FlYWRfY3R4KHRmbSk7Cj4gKyAgICAgICBz
dHJ1Y3QgZXNzaXZfYWVhZF9yZXF1ZXN0X2N0eCAqcmN0eCA9IGFlYWRfcmVxdWVzdF9jdHgocmVx
KTsKPiArICAgICAgIGludCBpdnNpemUgPSBjcnlwdG9fY2lwaGVyX2Jsb2Nrc2l6ZSh0Y3R4LT5l
c3Npdl9jaXBoZXIpOwo+ICsgICAgICAgaW50IHNzaXplID0gcmVxLT5hc3NvY2xlbiAtIGNyeXB0
b19hZWFkX2l2c2l6ZSh0Zm0pOwo+ICsgICAgICAgc3RydWN0IGFlYWRfcmVxdWVzdCAqc3VicmVx
ID0gJnJjdHgtPmFlYWRfcmVxOwo+ICsgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZzsKPiAr
Cj4gKyAgICAgICAvKgo+ICsgICAgICAgICogZG0tY3J5cHQgZW1iZWRzIHRoZSBzZWN0b3IgbnVt
YmVyIGFuZCB0aGUgSVYgaW4gdGhlIEFBRCByZWdpb24gc28gd2UKPiArICAgICAgICAqIGhhdmUg
dG8gc3BsaWNlIHRoZSBjb252ZXJ0ZWQgSVYgaW50byB0aGUgc3VicmVxdWVzdCB0aGF0IHdlIHBh
c3Mgb24KPiArICAgICAgICAqIHRvIHRoZSBBRUFEIHRyYW5zZm9ybS4gVGhpcyBtZWFucyB3ZSBh
cmUgdGlnaHRseSBjb3VwbGVkIHRvIGRtLWNyeXB0LAo+ICsgICAgICAgICogYnV0IHRoYXQgc2hv
dWxkIGJlIHRoZSBvbmx5IHVzZXIgb2YgdGhpcyBjb2RlIGluIEFFQUQgbW9kZS4KPiArICAgICAg
ICAqLwo+ICsgICAgICAgaWYgKHNzaXplIDwgMCB8fCBzZ19uZW50c19mb3JfbGVuKHJlcS0+c3Jj
LCBzc2l6ZSkgIT0gMSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsg
ICAgICAgbWVtc2V0KHJjdHgtPml2LCAwLCBpdnNpemUpOwo+ICsgICAgICAgbWVtY3B5KHJjdHgt
Pml2LCByZXEtPml2LCBjcnlwdG9fYWVhZF9pdnNpemUodGZtKSk7Cj4gKwo+ICsgICAgICAgY3J5
cHRvX2NpcGhlcl9lbmNyeXB0X29uZSh0Y3R4LT5lc3Npdl9jaXBoZXIsIHJjdHgtPml2LCByY3R4
LT5pdik7Cj4gKwo+ICsgICAgICAgc2dfaW5pdF90YWJsZShyY3R4LT5zcmMsIDQpOwo+ICsgICAg
ICAgc2dfc2V0X3BhZ2UocmN0eC0+c3JjLCBzZ19wYWdlKHJlcS0+c3JjKSwgc3NpemUsIHJlcS0+
c3JjLT5vZmZzZXQpOwo+ICsgICAgICAgc2dfc2V0X2J1ZihyY3R4LT5zcmMgKyAxLCByY3R4LT5p
diwgaXZzaXplKTsKPiArICAgICAgIHNnID0gc2NhdHRlcndhbGtfZmZ3ZChyY3R4LT5zcmMgKyAy
LCByZXEtPnNyYywgcmVxLT5hc3NvY2xlbik7Cj4gKyAgICAgICBpZiAoc2cgIT0gcmN0eC0+c3Jj
ICsgMikKPiArICAgICAgICAgICAgICAgc2dfY2hhaW4ocmN0eC0+c3JjLCAzLCBzZyk7Cj4gKwo+
ICsgICAgICAgc2dfaW5pdF90YWJsZShyY3R4LT5kc3QsIDQpOwo+ICsgICAgICAgc2dfc2V0X3Bh
Z2UocmN0eC0+ZHN0LCBzZ19wYWdlKHJlcS0+ZHN0KSwgc3NpemUsIHJlcS0+ZHN0LT5vZmZzZXQp
Owo+ICsgICAgICAgc2dfc2V0X2J1ZihyY3R4LT5kc3QgKyAxLCByY3R4LT5pdiwgaXZzaXplKTsK
PiArICAgICAgIHNnID0gc2NhdHRlcndhbGtfZmZ3ZChyY3R4LT5kc3QgKyAyLCByZXEtPmRzdCwg
cmVxLT5hc3NvY2xlbik7Cj4gKyAgICAgICBpZiAoc2cgIT0gcmN0eC0+ZHN0ICsgMikKPiArICAg
ICAgICAgICAgICAgc2dfY2hhaW4ocmN0eC0+ZHN0LCAzLCBzZyk7Cj4gKwo+ICsgICAgICAgYWVh
ZF9yZXF1ZXN0X3NldF90Zm0oc3VicmVxLCB0Y3R4LT51LmFlYWQpOwo+ICsgICAgICAgYWVhZF9y
ZXF1ZXN0X3NldF9jcnlwdChzdWJyZXEsIHJjdHgtPnNyYywgcmN0eC0+ZHN0LCByZXEtPmNyeXB0
bGVuLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByY3R4LT5pdik7Cj4gKyAgICAg
ICBhZWFkX3JlcXVlc3Rfc2V0X2FkKHN1YnJlcSwgc3NpemUgKyBpdnNpemUpOwo+ICsgICAgICAg
YWVhZF9yZXF1ZXN0X3NldF9jYWxsYmFjayhzdWJyZXEsIHJlcS0+YmFzZS5mbGFncywgZXNzaXZf
YWVhZF9kb25lLCByZXEpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IGVzc2l2X3NrY2lwaGVyX2VuY3J5cHQoc3RydWN0IHNrY2lwaGVyX3JlcXVlc3QgKnJl
cSkKPiArewo+ICsgICAgICAgc3RydWN0IGVzc2l2X3NrY2lwaGVyX3JlcXVlc3RfY3R4ICpyY3R4
ID0gc2tjaXBoZXJfcmVxdWVzdF9jdHgocmVxKTsKPiArCj4gKyAgICAgICBlc3Npdl9za2NpcGhl
cl9wcmVwYXJlX3N1YnJlcShyZXEpOwo+ICsgICAgICAgcmV0dXJuIGNyeXB0b19za2NpcGhlcl9l
bmNyeXB0KCZyY3R4LT5ibG9ja2NpcGhlcl9yZXEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGVz
c2l2X2FlYWRfZW5jcnlwdChzdHJ1Y3QgYWVhZF9yZXF1ZXN0ICpyZXEpCj4gK3sKPiArICAgICAg
IHN0cnVjdCBlc3Npdl9hZWFkX3JlcXVlc3RfY3R4ICpyY3R4ID0gYWVhZF9yZXF1ZXN0X2N0eChy
ZXEpOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICBlcnIgPSBlc3Npdl9hZWFkX3By
ZXBhcmVfc3VicmVxKHJlcSk7Cj4gKyAgICAgICBpZiAoZXJyKQo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gZXJyOwo+ICsgICAgICAgcmV0dXJuIGNyeXB0b19hZWFkX2VuY3J5cHQoJnJjdHgtPmFl
YWRfcmVxKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBlc3Npdl9za2NpcGhlcl9kZWNyeXB0KHN0
cnVjdCBza2NpcGhlcl9yZXF1ZXN0ICpyZXEpCj4gK3sKPiArICAgICAgIHN0cnVjdCBlc3Npdl9z
a2NpcGhlcl9yZXF1ZXN0X2N0eCAqcmN0eCA9IHNrY2lwaGVyX3JlcXVlc3RfY3R4KHJlcSk7Cj4g
KyAgICAgICByZXR1cm4gY3J5cHRvX3NrY2lwaGVyX2RlY3J5cHQoJnJjdHgtPmJsb2NrY2lwaGVy
X3JlcSk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZXNzaXZfYWVhZF9kZWNyeXB0KHN0cnVjdCBh
ZWFkX3JlcXVlc3QgKnJlcSkKPiArewo+ICsgICAgICAgc3RydWN0IGVzc2l2X2FlYWRfcmVxdWVz
dF9jdHggKnJjdHggPSBhZWFkX3JlcXVlc3RfY3R4KHJlcSk7Cj4gKyAgICAgICBpbnQgZXJyOwo+
ICsKPiArICAgICAgIGVyciA9IGVzc2l2X2FlYWRfcHJlcGFyZV9zdWJyZXEocmVxKTsKPiArICAg
ICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICsgICAgICAg
ZXNzaXZfYWVhZF9wcmVwYXJlX3N1YnJlcShyZXEpOwo+ICsgICAgICAgcmV0dXJuIGNyeXB0b19h
ZWFkX2RlY3J5cHQoJnJjdHgtPmFlYWRfcmVxKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBlc3Np
dl9pbml0X3RmbShzdHJ1Y3QgZXNzaXZfaW5zdGFuY2VfY3R4ICppY3R4LAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IGVzc2l2X3RmbV9jdHggKnRjdHgpCj4gK3sKPiArICAgICAg
IHN0cnVjdCBjcnlwdG9fY2lwaGVyICplc3Npdl9jaXBoZXI7Cj4gKyAgICAgICBzdHJ1Y3QgY3J5
cHRvX3NoYXNoICpoYXNoOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICBlc3Npdl9j
aXBoZXIgPSBjcnlwdG9fc3Bhd25fY2lwaGVyKCZpY3R4LT5lc3Npdl9jaXBoZXJfc3Bhd24pOwo+
ICsgICAgICAgaWYgKElTX0VSUihlc3Npdl9jaXBoZXIpKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gUFRSX0VSUihlc3Npdl9jaXBoZXIpOwo+ICsKPiArICAgICAgIGhhc2ggPSBjcnlwdG9fc3Bh
d25fc2hhc2goJmljdHgtPmhhc2hfc3Bhd24pOwo+ICsgICAgICAgaWYgKElTX0VSUihoYXNoKSkg
ewo+ICsgICAgICAgICAgICAgICBlcnIgPSBQVFJfRVJSKGhhc2gpOwo+ICsgICAgICAgICAgICAg
ICBnb3RvIGVycl9mcmVlX2Vzc2l2X2NpcGhlcjsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICB0
Y3R4LT5lc3Npdl9jaXBoZXIgPSBlc3Npdl9jaXBoZXI7Cj4gKyAgICAgICB0Y3R4LT5oYXNoID0g
aGFzaDsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK2Vycl9mcmVlX2Vzc2l2X2NpcGhl
cjoKPiArICAgICAgIGNyeXB0b19mcmVlX2NpcGhlcihlc3Npdl9jaXBoZXIpOwo+ICsgICAgICAg
cmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBlc3Npdl9za2NpcGhlcl9pbml0X3Rm
bShzdHJ1Y3QgY3J5cHRvX3NrY2lwaGVyICp0Zm0pCj4gK3sKPiArICAgICAgIHN0cnVjdCBza2Np
cGhlcl9pbnN0YW5jZSAqaW5zdCA9IHNrY2lwaGVyX2FsZ19pbnN0YW5jZSh0Zm0pOwo+ICsgICAg
ICAgc3RydWN0IGVzc2l2X2luc3RhbmNlX2N0eCAqaWN0eCA9IHNrY2lwaGVyX2luc3RhbmNlX2N0
eChpbnN0KTsKPiArICAgICAgIHN0cnVjdCBlc3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX3Nr
Y2lwaGVyX2N0eCh0Zm0pOwo+ICsgICAgICAgc3RydWN0IGNyeXB0b19za2NpcGhlciAqYmxvY2tj
aXBoZXI7Cj4gKyAgICAgICB1bnNpZ25lZCBpbnQgc3VicmVxX3NpemU7Cj4gKyAgICAgICBpbnQg
ZXJyOwo+ICsKPiArICAgICAgIEJVSUxEX0JVR19PTihvZmZzZXRvZmVuZChzdHJ1Y3QgZXNzaXZf
c2tjaXBoZXJfcmVxdWVzdF9jdHgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YmxvY2tjaXBoZXJfcmVxKSAhPQo+ICsgICAgICAgICAgICAgICAgICAgIHNpemVvZihzdHJ1Y3Qg
ZXNzaXZfc2tjaXBoZXJfcmVxdWVzdF9jdHgpKTsKPiArCj4gKyAgICAgICBibG9ja2NpcGhlciA9
IGNyeXB0b19zcGF3bl9za2NpcGhlcigmaWN0eC0+dS5ibG9ja2NpcGhlcl9zcGF3bik7Cj4gKyAg
ICAgICBpZiAoSVNfRVJSKGJsb2NrY2lwaGVyKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIFBU
Ul9FUlIoYmxvY2tjaXBoZXIpOwo+ICsKPiArICAgICAgIHN1YnJlcV9zaXplID0gRklFTERfU0la
RU9GKHN0cnVjdCBlc3Npdl9za2NpcGhlcl9yZXF1ZXN0X2N0eCwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJsb2NrY2lwaGVyX3JlcSkgKwo+ICsgICAgICAgICAgICAgICAg
ICAgICBjcnlwdG9fc2tjaXBoZXJfcmVxc2l6ZShibG9ja2NpcGhlcik7Cj4gKwo+ICsgICAgICAg
Y3J5cHRvX3NrY2lwaGVyX3NldF9yZXFzaXplKHRmbSwgb2Zmc2V0b2Yoc3RydWN0IGVzc2l2X3Nr
Y2lwaGVyX3JlcXVlc3RfY3R4LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYmxvY2tjaXBoZXJfcmVxKSArIHN1YnJlcV9zaXplKTsKPiArCj4gKyAg
ICAgICBlcnIgPSBlc3Npdl9pbml0X3RmbShpY3R4LCB0Y3R4KTsKPiArICAgICAgIGlmIChlcnIp
Cj4gKyAgICAgICAgICAgICAgIGNyeXB0b19mcmVlX3NrY2lwaGVyKGJsb2NrY2lwaGVyKTsKPiAr
Cj4gKyAgICAgICB0Y3R4LT51LmJsb2NrY2lwaGVyID0gYmxvY2tjaXBoZXI7Cj4gKyAgICAgICBy
ZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGVzc2l2X2FlYWRfaW5pdF90Zm0oc3Ry
dWN0IGNyeXB0b19hZWFkICp0Zm0pCj4gK3sKPiArICAgICAgIHN0cnVjdCBhZWFkX2luc3RhbmNl
ICppbnN0ID0gYWVhZF9hbGdfaW5zdGFuY2UodGZtKTsKPiArICAgICAgIHN0cnVjdCBlc3Npdl9p
bnN0YW5jZV9jdHggKmljdHggPSBhZWFkX2luc3RhbmNlX2N0eChpbnN0KTsKPiArICAgICAgIHN0
cnVjdCBlc3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX2FlYWRfY3R4KHRmbSk7Cj4gKyAgICAg
ICBzdHJ1Y3QgY3J5cHRvX2FlYWQgKmFlYWQ7Cj4gKyAgICAgICB1bnNpZ25lZCBpbnQgc3VicmVx
X3NpemU7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsKPiArICAgICAgIEJVSUxEX0JVR19PTihvZmZz
ZXRvZmVuZChzdHJ1Y3QgZXNzaXZfYWVhZF9yZXF1ZXN0X2N0eCwgYWVhZF9yZXEpICE9Cj4gKyAg
ICAgICAgICAgICAgICAgICAgc2l6ZW9mKHN0cnVjdCBlc3Npdl9hZWFkX3JlcXVlc3RfY3R4KSk7
Cj4gKwo+ICsgICAgICAgYWVhZCA9IGNyeXB0b19zcGF3bl9hZWFkKCZpY3R4LT51LmFlYWRfc3Bh
d24pOwo+ICsgICAgICAgaWYgKElTX0VSUihhZWFkKSkKPiArICAgICAgICAgICAgICAgcmV0dXJu
IFBUUl9FUlIoYWVhZCk7Cj4gKwo+ICsgICAgICAgc3VicmVxX3NpemUgPSBGSUVMRF9TSVpFT0Yo
c3RydWN0IGVzc2l2X2FlYWRfcmVxdWVzdF9jdHgsIGFlYWRfcmVxKSArCj4gKyAgICAgICAgICAg
ICAgICAgICAgIGNyeXB0b19hZWFkX3JlcXNpemUoYWVhZCk7Cj4gKwo+ICsgICAgICAgY3J5cHRv
X2FlYWRfc2V0X3JlcXNpemUodGZtLCBvZmZzZXRvZihzdHJ1Y3QgZXNzaXZfYWVhZF9yZXF1ZXN0
X2N0eCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWVh
ZF9yZXEpICsgc3VicmVxX3NpemUpOwo+ICsKPiArICAgICAgIGVyciA9IGVzc2l2X2luaXRfdGZt
KGljdHgsIHRjdHgpOwo+ICsgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgY3J5cHRv
X2ZyZWVfYWVhZChhZWFkKTsKPiArCj4gKyAgICAgICB0Y3R4LT51LmFlYWQgPSBhZWFkOwo+ICsg
ICAgICAgcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXNzaXZfc2tjaXBoZXJf
ZXhpdF90Zm0oc3RydWN0IGNyeXB0b19za2NpcGhlciAqdGZtKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgZXNzaXZfdGZtX2N0eCAqdGN0eCA9IGNyeXB0b19za2NpcGhlcl9jdHgodGZtKTsKPiArCj4g
KyAgICAgICBjcnlwdG9fZnJlZV9za2NpcGhlcih0Y3R4LT51LmJsb2NrY2lwaGVyKTsKPiArICAg
ICAgIGNyeXB0b19mcmVlX2NpcGhlcih0Y3R4LT5lc3Npdl9jaXBoZXIpOwo+ICsgICAgICAgY3J5
cHRvX2ZyZWVfc2hhc2godGN0eC0+aGFzaCk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGVzc2l2
X2FlYWRfZXhpdF90Zm0oc3RydWN0IGNyeXB0b19hZWFkICp0Zm0pCj4gK3sKPiArICAgICAgIHN0
cnVjdCBlc3Npdl90Zm1fY3R4ICp0Y3R4ID0gY3J5cHRvX2FlYWRfY3R4KHRmbSk7Cj4gKwo+ICsg
ICAgICAgY3J5cHRvX2ZyZWVfYWVhZCh0Y3R4LT51LmFlYWQpOwo+ICsgICAgICAgY3J5cHRvX2Zy
ZWVfY2lwaGVyKHRjdHgtPmVzc2l2X2NpcGhlcik7Cj4gKyAgICAgICBjcnlwdG9fZnJlZV9zaGFz
aCh0Y3R4LT5oYXNoKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXNzaXZfc2tjaXBoZXJfZnJl
ZV9pbnN0YW5jZShzdHJ1Y3Qgc2tjaXBoZXJfaW5zdGFuY2UgKmluc3QpCj4gK3sKPiArICAgICAg
IHN0cnVjdCBlc3Npdl9pbnN0YW5jZV9jdHggKmljdHggPSBza2NpcGhlcl9pbnN0YW5jZV9jdHgo
aW5zdCk7Cj4gKwo+ICsgICAgICAgY3J5cHRvX2Ryb3Bfc2tjaXBoZXIoJmljdHgtPnUuYmxvY2tj
aXBoZXJfc3Bhd24pOwo+ICsgICAgICAgY3J5cHRvX2Ryb3Bfc3Bhd24oJmljdHgtPmVzc2l2X2Np
cGhlcl9zcGF3bik7Cj4gKyAgICAgICBjcnlwdG9fZHJvcF9zaGFzaCgmaWN0eC0+aGFzaF9zcGF3
bik7Cj4gKyAgICAgICBrZnJlZShpbnN0KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXNzaXZf
YWVhZF9mcmVlX2luc3RhbmNlKHN0cnVjdCBhZWFkX2luc3RhbmNlICppbnN0KQo+ICt7Cj4gKyAg
ICAgICBzdHJ1Y3QgZXNzaXZfaW5zdGFuY2VfY3R4ICppY3R4ID0gYWVhZF9pbnN0YW5jZV9jdHgo
aW5zdCk7Cj4gKwo+ICsgICAgICAgY3J5cHRvX2Ryb3BfYWVhZCgmaWN0eC0+dS5hZWFkX3NwYXdu
KTsKPiArICAgICAgIGNyeXB0b19kcm9wX3NwYXduKCZpY3R4LT5lc3Npdl9jaXBoZXJfc3Bhd24p
Owo+ICsgICAgICAgY3J5cHRvX2Ryb3Bfc2hhc2goJmljdHgtPmhhc2hfc3Bhd24pOwo+ICsgICAg
ICAga2ZyZWUoaW5zdCk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIGVzc2l2X3N1cHBvcnRlZF9h
bGdvcml0aG1zKHN0cnVjdCBjcnlwdG9fYWxnICplc3Npdl9jaXBoZXJfYWxnLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzaGFzaF9hbGcgKmhhc2hfYWxn
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBpdnNpemUpCj4g
K3sKPiArICAgICAgIGlmIChoYXNoX2FsZy0+ZGlnZXN0c2l6ZSA8IGVzc2l2X2NpcGhlcl9hbGct
PmNyYV9jaXBoZXIuY2lhX21pbl9rZXlzaXplIHx8Cj4gKyAgICAgICAgICAgaGFzaF9hbGctPmRp
Z2VzdHNpemUgPiBlc3Npdl9jaXBoZXJfYWxnLT5jcmFfY2lwaGVyLmNpYV9tYXhfa2V5c2l6ZSkK
PiArICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsKPiArICAgICAgIGlmIChpdnNpemUg
IT0gZXNzaXZfY2lwaGVyX2FsZy0+Y3JhX2Jsb2Nrc2l6ZSkKPiArICAgICAgICAgICAgICAgcmV0
dXJuIGZhbHNlOwo+ICsKPiArICAgICAgIGlmIChpdnNpemUgPiBNQVhfSU5ORVJfSVZfU0laRSkK
PiArICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsKPiArICAgICAgIHJldHVybiB0cnVl
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGVzc2l2X2NyZWF0ZShzdHJ1Y3QgY3J5cHRvX3RlbXBs
YXRlICp0bXBsLCBzdHJ1Y3QgcnRhdHRyICoqdGIpCj4gK3sKPiArICAgICAgIHN0cnVjdCBjcnlw
dG9fYXR0cl90eXBlICphbGd0Owo+ICsgICAgICAgY29uc3QgY2hhciAqYmxvY2tjaXBoZXJfbmFt
ZTsKPiArICAgICAgIGNvbnN0IGNoYXIgKmVzc2l2X2NpcGhlcl9uYW1lOwo+ICsgICAgICAgY29u
c3QgY2hhciAqc2hhc2hfbmFtZTsKPiArICAgICAgIHN0cnVjdCBza2NpcGhlcl9pbnN0YW5jZSAq
c2tjaXBoZXJfaW5zdCA9IE5VTEw7Cj4gKyAgICAgICBzdHJ1Y3QgYWVhZF9pbnN0YW5jZSAqYWVh
ZF9pbnN0ID0gTlVMTDsKPiArICAgICAgIHN0cnVjdCBjcnlwdG9faW5zdGFuY2UgKmluc3Q7Cj4g
KyAgICAgICBzdHJ1Y3QgY3J5cHRvX2FsZyAqYmFzZSwgKmJsb2NrX2Jhc2U7Cj4gKyAgICAgICBz
dHJ1Y3QgZXNzaXZfaW5zdGFuY2VfY3R4ICppY3R4Owo+ICsgICAgICAgc3RydWN0IHNrY2lwaGVy
X2FsZyAqYmxvY2tjaXBoZXJfYWxnID0gTlVMTDsKPiArICAgICAgIHN0cnVjdCBhZWFkX2FsZyAq
YWVhZF9hbGcgPSBOVUxMOwo+ICsgICAgICAgc3RydWN0IGNyeXB0b19hbGcgKmVzc2l2X2NpcGhl
cl9hbGc7Cj4gKyAgICAgICBzdHJ1Y3QgY3J5cHRvX2FsZyAqX2hhc2hfYWxnOwo+ICsgICAgICAg
c3RydWN0IHNoYXNoX2FsZyAqaGFzaF9hbGc7Cj4gKyAgICAgICBpbnQgaXZzaXplOwo+ICsgICAg
ICAgdTMyIHR5cGU7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsKPiArICAgICAgIGFsZ3QgPSBjcnlw
dG9fZ2V0X2F0dHJfdHlwZSh0Yik7Cj4gKyAgICAgICBpZiAoSVNfRVJSKGFsZ3QpKQo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gUFRSX0VSUihhbGd0KTsKPiArCj4gKyAgICAgICBibG9ja2NpcGhl
cl9uYW1lID0gY3J5cHRvX2F0dHJfYWxnX25hbWUodGJbMV0pOwo+ICsgICAgICAgaWYgKElTX0VS
UihibG9ja2NpcGhlcl9uYW1lKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoYmxv
Y2tjaXBoZXJfbmFtZSk7Cj4gKwo+ICsgICAgICAgZXNzaXZfY2lwaGVyX25hbWUgPSBjcnlwdG9f
YXR0cl9hbGdfbmFtZSh0YlsyXSk7Cj4gKyAgICAgICBpZiAoSVNfRVJSKGVzc2l2X2NpcGhlcl9u
YW1lKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoZXNzaXZfY2lwaGVyX25hbWUp
Owo+ICsKPiArICAgICAgIHNoYXNoX25hbWUgPSBjcnlwdG9fYXR0cl9hbGdfbmFtZSh0YlszXSk7
Cj4gKyAgICAgICBpZiAoSVNfRVJSKHNoYXNoX25hbWUpKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gUFRSX0VSUihzaGFzaF9uYW1lKTsKPiArCj4gKyAgICAgICB0eXBlID0gYWxndC0+dHlwZSAm
IGFsZ3QtPm1hc2s7Cj4gKwo+ICsgICAgICAgc3dpdGNoICh0eXBlKSB7Cj4gKyAgICAgICBjYXNl
IENSWVBUT19BTEdfVFlQRV9CTEtDSVBIRVI6Cj4gKyAgICAgICAgICAgICAgIHNrY2lwaGVyX2lu
c3QgPSBremFsbG9jKHNpemVvZigqc2tjaXBoZXJfaW5zdCkgKwo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzaXplb2YoKmljdHgpLCBHRlBfS0VSTkVMKTsKPiArICAg
ICAgICAgICAgICAgaWYgKCFza2NpcGhlcl9pbnN0KQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiAtRU5PTUVNOwo+ICsgICAgICAgICAgICAgICBpbnN0ID0gc2tjaXBoZXJfY3J5cHRv
X2luc3RhbmNlKHNrY2lwaGVyX2luc3QpOwo+ICsgICAgICAgICAgICAgICBiYXNlID0gJnNrY2lw
aGVyX2luc3QtPmFsZy5iYXNlOwo+ICsgICAgICAgICAgICAgICBpY3R4ID0gY3J5cHRvX2luc3Rh
bmNlX2N0eChpbnN0KTsKPiArCj4gKyAgICAgICAgICAgICAgIC8qIEJsb2NrIGNpcGhlciwgZS5n
LiAiY2JjKGFlcykiICovCj4gKyAgICAgICAgICAgICAgIGNyeXB0b19zZXRfc2tjaXBoZXJfc3Bh
d24oJmljdHgtPnUuYmxvY2tjaXBoZXJfc3Bhd24sIGluc3QpOwo+ICsgICAgICAgICAgICAgICBl
cnIgPSBjcnlwdG9fZ3JhYl9za2NpcGhlcigmaWN0eC0+dS5ibG9ja2NpcGhlcl9zcGF3biwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tjaXBoZXJfbmFt
ZSwgMCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3J5cHRv
X3JlcXVpcmVzX3N5bmMoYWxndC0+dHlwZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxndC0+bWFzaykpOwo+ICsgICAg
ICAgICAgICAgICBpZiAoZXJyKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2Zy
ZWVfaW5zdDsKPiArICAgICAgICAgICAgICAgYmxvY2tjaXBoZXJfYWxnID0gY3J5cHRvX3NwYXdu
X3NrY2lwaGVyX2FsZygmaWN0eC0+dS5ibG9ja2NpcGhlcl9zcGF3bik7Cj4gKyAgICAgICAgICAg
ICAgIGJsb2NrX2Jhc2UgPSAmYmxvY2tjaXBoZXJfYWxnLT5iYXNlOwo+ICsgICAgICAgICAgICAg
ICBpdnNpemUgPSBibG9ja2NpcGhlcl9hbGctPml2c2l6ZTsKPiArICAgICAgICAgICAgICAgYnJl
YWs7Cj4gKwo+ICsgICAgICAgY2FzZSBDUllQVE9fQUxHX1RZUEVfQUVBRDoKPiArICAgICAgICAg
ICAgICAgYWVhZF9pbnN0ID0ga3phbGxvYyhzaXplb2YoKmFlYWRfaW5zdCkgKwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZigqaWN0eCksIEdGUF9LRVJORUwpOwo+
ICsgICAgICAgICAgICAgICBpZiAoIWFlYWRfaW5zdCkKPiArICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVOT01FTTsKPiArICAgICAgICAgICAgICAgaW5zdCA9IGFlYWRfY3J5cHRvX2lu
c3RhbmNlKGFlYWRfaW5zdCk7Cj4gKyAgICAgICAgICAgICAgIGJhc2UgPSAmYWVhZF9pbnN0LT5h
bGcuYmFzZTsKPiArICAgICAgICAgICAgICAgaWN0eCA9IGNyeXB0b19pbnN0YW5jZV9jdHgoaW5z
dCk7Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBBRUFEIGNpcGhlciwgZS5nLiAiYXV0aGVuYyho
bWFjKHNoYTI1NiksY2JjKGFlcykpIiAqLwo+ICsgICAgICAgICAgICAgICBjcnlwdG9fc2V0X2Fl
YWRfc3Bhd24oJmljdHgtPnUuYWVhZF9zcGF3biwgaW5zdCk7Cj4gKyAgICAgICAgICAgICAgIGVy
ciA9IGNyeXB0b19ncmFiX2FlYWQoJmljdHgtPnUuYWVhZF9zcGF3biwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja2NpcGhlcl9uYW1lLCAwLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyeXB0b19yZXF1aXJlc19zeW5jKGFsZ3Qt
PnR5cGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWxndC0+bWFzaykpOwo+ICsgICAgICAgICAgICAgICBpZiAoZXJyKQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ZyZWVfaW5zdDsKPiArICAgICAgICAgICAg
ICAgYWVhZF9hbGcgPSBjcnlwdG9fc3Bhd25fYWVhZF9hbGcoJmljdHgtPnUuYWVhZF9zcGF3bik7
Cj4gKyAgICAgICAgICAgICAgIGJsb2NrX2Jhc2UgPSAmYWVhZF9hbGctPmJhc2U7Cj4gKyAgICAg
ICAgICAgICAgIGl2c2l6ZSA9IGFlYWRfYWxnLT5pdnNpemU7Cj4gKyAgICAgICAgICAgICAgIGJy
ZWFrOwo+ICsKPiArICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIC8qIEJsb2NrIGNpcGhlciwgZS5nLiAiYWVz
IiAqLwo+ICsgICAgICAgY3J5cHRvX3NldF9zcGF3bigmaWN0eC0+ZXNzaXZfY2lwaGVyX3NwYXdu
LCBpbnN0KTsKPiArICAgICAgIGVyciA9IGNyeXB0b19ncmFiX3NwYXduKCZpY3R4LT5lc3Npdl9j
aXBoZXJfc3Bhd24sIGVzc2l2X2NpcGhlcl9uYW1lLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgQ1JZUFRPX0FMR19UWVBFX0NJUEhFUiwgQ1JZUFRPX0FMR19UWVBFX01BU0spOwo+
ICsgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgZ290byBvdXRfZHJvcF9ibG9ja2Np
cGhlcjsKPiArICAgICAgIGVzc2l2X2NpcGhlcl9hbGcgPSBpY3R4LT5lc3Npdl9jaXBoZXJfc3Bh
d24uYWxnOwo+ICsKPiArICAgICAgIC8qIFN5bmNocm9ub3VzIGhhc2gsIGUuZy4sICJzaGEyNTYi
ICovCj4gKyAgICAgICBfaGFzaF9hbGcgPSBjcnlwdG9fYWxnX21vZF9sb29rdXAoc2hhc2hfbmFt
ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDUllQVE9fQUxH
X1RZUEVfU0hBU0gsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Q1JZUFRPX0FMR19UWVBFX01BU0spOwo+ICsgICAgICAgaWYgKElTX0VSUihfaGFzaF9hbGcpKSB7
Cj4gKyAgICAgICAgICAgICAgIGVyciA9IFBUUl9FUlIoX2hhc2hfYWxnKTsKPiArICAgICAgICAg
ICAgICAgZ290byBvdXRfZHJvcF9lc3Npdl9jaXBoZXI7Cj4gKyAgICAgICB9Cj4gKyAgICAgICBo
YXNoX2FsZyA9IF9fY3J5cHRvX3NoYXNoX2FsZyhfaGFzaF9hbGcpOwo+ICsgICAgICAgZXJyID0g
Y3J5cHRvX2luaXRfc2hhc2hfc3Bhd24oJmljdHgtPmhhc2hfc3Bhd24sIGhhc2hfYWxnLCBpbnN0
KTsKPiArICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X3B1dF9oYXNo
Owo+ICsKPiArICAgICAgIC8qIENoZWNrIHRoZSBzZXQgb2YgYWxnb3JpdGhtcyAqLwo+ICsgICAg
ICAgaWYgKCFlc3Npdl9zdXBwb3J0ZWRfYWxnb3JpdGhtcyhlc3Npdl9jaXBoZXJfYWxnLCBoYXNo
X2FsZywgaXZzaXplKSkgewo+ICsgICAgICAgICAgICAgICBwcl93YXJuKCJVbnN1cHBvcnRlZCBl
c3NpdiBpbnN0YW50aWF0aW9uOiAoJXMsJXMsJXMpXG4iLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGJsb2NrX2Jhc2UtPmNyYV9uYW1lLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVzc2l2
X2NpcGhlcl9hbGctPmNyYV9uYW1lLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIGhhc2hfYWxn
LT5iYXNlLmNyYV9uYW1lKTsKPiArICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAg
ICAgICAgICAgICAgZ290byBvdXRfZHJvcF9oYXNoOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IC8qIEluc3RhbmNlIGZpZWxkcyAqLwo+ICsKPiArICAgICAgIGVyciA9IC1FTkFNRVRPT0xPTkc7
Cj4gKyAgICAgICBpZiAoc25wcmludGYoYmFzZS0+Y3JhX25hbWUsIENSWVBUT19NQVhfQUxHX05B
TUUsCj4gKyAgICAgICAgICAgICAgICAgICAgImVzc2l2KCVzLCVzLCVzKSIsIGJsb2NrX2Jhc2Ut
PmNyYV9uYW1lLAo+ICsgICAgICAgICAgICAgICAgICAgIGVzc2l2X2NpcGhlcl9hbGctPmNyYV9u
YW1lLAo+ICsgICAgICAgICAgICAgICAgICAgIGhhc2hfYWxnLT5iYXNlLmNyYV9uYW1lKSA+PSBD
UllQVE9fTUFYX0FMR19OQU1FKQo+ICsgICAgICAgICAgICAgICBnb3RvIG91dF9kcm9wX2hhc2g7
Cj4gKyAgICAgICBpZiAoc25wcmludGYoYmFzZS0+Y3JhX2RyaXZlcl9uYW1lLCBDUllQVE9fTUFY
X0FMR19OQU1FLAo+ICsgICAgICAgICAgICAgICAgICAgICJlc3NpdiglcywlcywlcykiLAo+ICsg
ICAgICAgICAgICAgICAgICAgIGJsb2NrX2Jhc2UtPmNyYV9kcml2ZXJfbmFtZSwKPiArICAgICAg
ICAgICAgICAgICAgICBlc3Npdl9jaXBoZXJfYWxnLT5jcmFfZHJpdmVyX25hbWUsCj4gKyAgICAg
ICAgICAgICAgICAgICAgaGFzaF9hbGctPmJhc2UuY3JhX2RyaXZlcl9uYW1lKSA+PSBDUllQVE9f
TUFYX0FMR19OQU1FKQo+ICsgICAgICAgICAgICAgICBnb3RvIG91dF9kcm9wX2hhc2g7Cj4gKwo+
ICsgICAgICAgYmFzZS0+Y3JhX2ZsYWdzICAgICAgICAgPSBibG9ja19iYXNlLT5jcmFfZmxhZ3Mg
JiBDUllQVE9fQUxHX0FTWU5DOwo+ICsgICAgICAgYmFzZS0+Y3JhX2Jsb2Nrc2l6ZSAgICAgPSBi
bG9ja19iYXNlLT5jcmFfYmxvY2tzaXplOwo+ICsgICAgICAgYmFzZS0+Y3JhX2N0eHNpemUgICAg
ICAgPSBzaXplb2Yoc3RydWN0IGVzc2l2X3RmbV9jdHgpOwo+ICsgICAgICAgYmFzZS0+Y3JhX2Fs
aWdubWFzayAgICAgPSBibG9ja19iYXNlLT5jcmFfYWxpZ25tYXNrOwo+ICsgICAgICAgYmFzZS0+
Y3JhX3ByaW9yaXR5ICAgICAgPSBibG9ja19iYXNlLT5jcmFfcHJpb3JpdHk7Cj4gKwo+ICsgICAg
ICAgaWYgKHR5cGUgPT0gQ1JZUFRPX0FMR19UWVBFX0JMS0NJUEhFUikgewo+ICsgICAgICAgICAg
ICAgICBza2NpcGhlcl9pbnN0LT5hbGcuc2V0a2V5ICAgICAgID0gZXNzaXZfc2tjaXBoZXJfc2V0
a2V5Owo+ICsgICAgICAgICAgICAgICBza2NpcGhlcl9pbnN0LT5hbGcuZW5jcnlwdCAgICAgID0g
ZXNzaXZfc2tjaXBoZXJfZW5jcnlwdDsKPiArICAgICAgICAgICAgICAgc2tjaXBoZXJfaW5zdC0+
YWxnLmRlY3J5cHQgICAgICA9IGVzc2l2X3NrY2lwaGVyX2RlY3J5cHQ7Cj4gKyAgICAgICAgICAg
ICAgIHNrY2lwaGVyX2luc3QtPmFsZy5pbml0ICAgICAgICAgPSBlc3Npdl9za2NpcGhlcl9pbml0
X3RmbTsKPiArICAgICAgICAgICAgICAgc2tjaXBoZXJfaW5zdC0+YWxnLmV4aXQgICAgICAgICA9
IGVzc2l2X3NrY2lwaGVyX2V4aXRfdGZtOwo+ICsKPiArICAgICAgICAgICAgICAgc2tjaXBoZXJf
aW5zdC0+YWxnLm1pbl9rZXlzaXplICA9IGNyeXB0b19za2NpcGhlcl9hbGdfbWluX2tleXNpemUo
YmxvY2tjaXBoZXJfYWxnKTsKPiArICAgICAgICAgICAgICAgc2tjaXBoZXJfaW5zdC0+YWxnLm1h
eF9rZXlzaXplICA9IGNyeXB0b19za2NpcGhlcl9hbGdfbWF4X2tleXNpemUoYmxvY2tjaXBoZXJf
YWxnKTsKPiArICAgICAgICAgICAgICAgc2tjaXBoZXJfaW5zdC0+YWxnLml2c2l6ZSAgICAgICA9
IEVTU0lWX0lWX1NJWkU7Cj4gKyAgICAgICAgICAgICAgIHNrY2lwaGVyX2luc3QtPmFsZy5jaHVu
a3NpemUgICAgPSBibG9ja2NpcGhlcl9hbGctPmNodW5rc2l6ZTsKPiArICAgICAgICAgICAgICAg
c2tjaXBoZXJfaW5zdC0+YWxnLndhbGtzaXplICAgICA9IGJsb2NrY2lwaGVyX2FsZy0+d2Fsa3Np
emU7Cj4gKwo+ICsgICAgICAgICAgICAgICBza2NpcGhlcl9pbnN0LT5mcmVlICAgICAgICAgICAg
ID0gZXNzaXZfc2tjaXBoZXJfZnJlZV9pbnN0YW5jZTsKPiArCj4gKyAgICAgICAgICAgICAgIGVy
ciA9IHNrY2lwaGVyX3JlZ2lzdGVyX2luc3RhbmNlKHRtcGwsIHNrY2lwaGVyX2luc3QpOwo+ICsg
ICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgYWVhZF9pbnN0LT5hbGcuc2V0a2V5ICAg
ICAgICAgICA9IGVzc2l2X2FlYWRfc2V0a2V5Owo+ICsgICAgICAgICAgICAgICBhZWFkX2luc3Qt
PmFsZy5zZXRhdXRoc2l6ZSAgICAgID0gZXNzaXZfYWVhZF9zZXRhdXRoc2l6ZTsKPiArICAgICAg
ICAgICAgICAgYWVhZF9pbnN0LT5hbGcuZW5jcnlwdCAgICAgICAgICA9IGVzc2l2X2FlYWRfZW5j
cnlwdDsKPiArICAgICAgICAgICAgICAgYWVhZF9pbnN0LT5hbGcuZGVjcnlwdCAgICAgICAgICA9
IGVzc2l2X2FlYWRfZGVjcnlwdDsKPiArICAgICAgICAgICAgICAgYWVhZF9pbnN0LT5hbGcuaW5p
dCAgICAgICAgICAgICA9IGVzc2l2X2FlYWRfaW5pdF90Zm07Cj4gKyAgICAgICAgICAgICAgIGFl
YWRfaW5zdC0+YWxnLmV4aXQgICAgICAgICAgICAgPSBlc3Npdl9hZWFkX2V4aXRfdGZtOwo+ICsK
PiArICAgICAgICAgICAgICAgYWVhZF9pbnN0LT5hbGcuaXZzaXplICAgICAgICAgICA9IEVTU0lW
X0lWX1NJWkU7Cj4gKyAgICAgICAgICAgICAgIGFlYWRfaW5zdC0+YWxnLm1heGF1dGhzaXplICAg
ICAgPSBhZWFkX2FsZy0+bWF4YXV0aHNpemU7Cj4gKyAgICAgICAgICAgICAgIGFlYWRfaW5zdC0+
YWxnLmNodW5rc2l6ZSAgICAgICAgPSBhZWFkX2FsZy0+Y2h1bmtzaXplOwo+ICsKPiArICAgICAg
ICAgICAgICAgYWVhZF9pbnN0LT5mcmVlICAgICAgICAgICAgICAgICA9IGVzc2l2X2FlYWRfZnJl
ZV9pbnN0YW5jZTsKPiArCj4gKyAgICAgICAgICAgICAgIGVyciA9IGFlYWRfcmVnaXN0ZXJfaW5z
dGFuY2UodG1wbCwgYWVhZF9pbnN0KTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAoZXJy
KQo+ICsgICAgICAgICAgICAgICBnb3RvIG91dF9kcm9wX2hhc2g7Cj4gKwo+ICsgICAgICAgY3J5
cHRvX21vZF9wdXQoX2hhc2hfYWxnKTsKPiArICAgICAgIHJldHVybiAwOwo+ICsKPiArb3V0X2Ry
b3BfaGFzaDoKPiArICAgICAgIGNyeXB0b19kcm9wX3NoYXNoKCZpY3R4LT5oYXNoX3NwYXduKTsK
PiArb3V0X3B1dF9oYXNoOgo+ICsgICAgICAgY3J5cHRvX21vZF9wdXQoX2hhc2hfYWxnKTsKPiAr
b3V0X2Ryb3BfZXNzaXZfY2lwaGVyOgo+ICsgICAgICAgY3J5cHRvX2Ryb3Bfc3Bhd24oJmljdHgt
PmVzc2l2X2NpcGhlcl9zcGF3bik7Cj4gK291dF9kcm9wX2Jsb2NrY2lwaGVyOgo+ICsgICAgICAg
aWYgKHR5cGUgPT0gQ1JZUFRPX0FMR19UWVBFX0JMS0NJUEhFUikgewo+ICsgICAgICAgICAgICAg
ICBjcnlwdG9fZHJvcF9za2NpcGhlcigmaWN0eC0+dS5ibG9ja2NpcGhlcl9zcGF3bik7Cj4gKyAg
ICAgICB9IGVsc2Ugewo+ICsgICAgICAgICAgICAgICBjcnlwdG9fZHJvcF9hZWFkKCZpY3R4LT51
LmFlYWRfc3Bhd24pOwo+ICsgICAgICAgfQo+ICtvdXRfZnJlZV9pbnN0Ogo+ICsgICAgICAga2Zy
ZWUoc2tjaXBoZXJfaW5zdCk7Cj4gKyAgICAgICBrZnJlZShhZWFkX2luc3QpOwo+ICsgICAgICAg
cmV0dXJuIGVycjsKPiArfQo+ICsKPiArLyogZXNzaXYoYmxvY2tjaXBoZXJfbmFtZSwgZXNzaXZf
Y2lwaGVyX25hbWUsIHNoYXNoX25hbWUpICovCj4gK3N0YXRpYyBzdHJ1Y3QgY3J5cHRvX3RlbXBs
YXRlIGVzc2l2X3RtcGwgPSB7Cj4gKyAgICAgICAubmFtZSAgID0gImVzc2l2IiwKPiArICAgICAg
IC5jcmVhdGUgPSBlc3Npdl9jcmVhdGUsCj4gKyAgICAgICAubW9kdWxlID0gVEhJU19NT0RVTEUs
Cj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IF9faW5pdCBlc3Npdl9tb2R1bGVfaW5pdCh2b2lkKQo+
ICt7Cj4gKyAgICAgICByZXR1cm4gY3J5cHRvX3JlZ2lzdGVyX3RlbXBsYXRlKCZlc3Npdl90bXBs
KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX19leGl0IGVzc2l2X21vZHVsZV9leGl0KHZvaWQp
Cj4gK3sKPiArICAgICAgIGNyeXB0b191bnJlZ2lzdGVyX3RlbXBsYXRlKCZlc3Npdl90bXBsKTsK
PiArfQo+ICsKPiArc3Vic3lzX2luaXRjYWxsKGVzc2l2X21vZHVsZV9pbml0KTsKPiArbW9kdWxl
X2V4aXQoZXNzaXZfbW9kdWxlX2V4aXQpOwo+ICsKPiArTU9EVUxFX0RFU0NSSVBUSU9OKCJFU1NJ
ViBza2NpcGhlci9hZWFkIHdyYXBwZXIgZm9yIGJsb2NrIGVuY3J5cHRpb24iKTsKPiArTU9EVUxF
X0xJQ0VOU0UoIkdQTCB2MiIpOwo+ICtNT0RVTEVfQUxJQVNfQ1JZUFRPKCJlc3NpdiIpOwo+IC0t
Cj4gMi4xNy4xCj4KCi0tCmRtLWRldmVsIG1haWxpbmcgbGlzdApkbS1kZXZlbEByZWRoYXQuY29t
Cmh0dHBzOi8vd3d3LnJlZGhhdC5jb20vbWFpbG1hbi9saXN0aW5mby9kbS1kZXZlbA==
